# Quickstart: 필지 데이터 영속성 및 마커 표시 개선

## Overview
이 가이드는 새로운 필지 색상 영속성과 마커 표시 조건 기능을 빠르게 테스트하고 검증하는 방법을 설명합니다.

## Prerequisites
- Node.js 18+ 설치
- 브라우저 (Chrome, Firefox, Safari, Edge 중 하나)
- Supabase 계정 및 프로젝트
- 네이버 지도 API 키

## Setup

### 1. 환경 변수 설정
```bash
# .env 파일 생성 또는 수정
SUPABASE_URL=https://cqfszcbifonxpfasodto.supabase.co
SUPABASE_ANON_KEY=your_key_here
VWORLD_API_KEY=E5B1657B-9B6F-3A4B-91EF-98512BE931A1
```

### 2. 서버 시작
```bash
# 개발 서버 실행
node server.js
# 브라우저에서 http://localhost:3000 접속
```

## Feature Testing Scenarios

### Scenario 1: 색상 즉시 저장 테스트
**목적**: 색상 선택 시 즉시 저장되는지 확인

1. 지도에서 필지 클릭
2. 색상 팔레트에서 색상 선택
3. 개발자 도구 Network 탭 확인
   - POST 요청이 즉시 발생하는지 확인
   - 응답 시간이 100ms 이내인지 확인
4. LocalStorage 확인
   ```javascript
   // 콘솔에서 실행
   console.log(localStorage.getItem('parcelColors'));
   ```

**예상 결과**:
- 색상이 즉시 지도에 표시됨
- 네트워크 요청 성공 (200 OK)
- LocalStorage에 색상 데이터 저장됨

### Scenario 2: 새로고침 후 색상 유지 테스트
**목적**: 브라우저 새로고침 후에도 색상이 유지되는지 확인

1. 여러 필지에 다른 색상 적용
2. 브라우저 새로고침 (F5)
3. 지도 로드 완료 대기
4. 이전에 적용한 색상들이 복원되었는지 확인

**예상 결과**:
- 모든 색상이 이전 상태 그대로 표시됨
- 로딩 시간 < 500ms

### Scenario 3: 확장된 마커 생성 조건 테스트
**목적**: 메모 외 다른 필드로도 마커가 생성되는지 확인

#### 3.1 지번으로 마커 생성
1. 필지 클릭
2. 지번 필드만 입력
3. 마커 생성 확인

#### 3.2 소유자 이름으로 마커 생성
1. 다른 필지 클릭
2. 소유자 이름만 입력
3. 마커 생성 확인

#### 3.3 연락처로 마커 생성
1. 또 다른 필지 클릭
2. 연락처만 입력
3. 마커 생성 확인

**예상 결과**:
- 각 필드 입력 시 즉시 마커 생성
- 마커 아이콘이 정상적으로 표시됨

### Scenario 4: 마커 제거 조건 테스트
**목적**: 모든 정보 삭제 시 마커가 제거되는지 확인

1. 정보가 입력된 필지 선택 (마커 있음)
2. 모든 필드 내용 삭제
3. 저장 또는 포커스 아웃
4. 마커 제거 확인

**예상 결과**:
- 마커가 지도에서 사라짐
- 콘솔에 에러 없음

### Scenario 5: 대량 데이터 성능 테스트
**목적**: 많은 필지에 색상/마커가 있을 때 성능 확인

1. 50개 이상 필지에 색상 적용
2. 30개 이상 필지에 정보 입력 (마커 생성)
3. 새로고침
4. 로딩 시간 측정

**예상 결과**:
- 초기 로드 < 2초
- 부드러운 지도 이동 (프레임 드롭 없음)
- 메모리 사용량 안정적

### Scenario 6: 오프라인 모드 테스트
**목적**: 네트워크 없이도 기본 기능이 작동하는지 확인

1. 개발자 도구 > Network > Offline 체크
2. 필지 색상 변경 시도
3. 필지 정보 입력 시도
4. Online 복원 후 동기화 확인

**예상 결과**:
- 오프라인에서도 UI 업데이트 정상 작동
- Online 복원 시 자동 동기화
- 데이터 손실 없음

## Validation Checklist

### 기능 검증
- [ ] 색상 클릭 즉시 저장
- [ ] 새로고침 후 색상 유지
- [ ] 새로고침 후 마커 유지
- [ ] 지번 입력 시 마커 생성
- [ ] 소유자명 입력 시 마커 생성
- [ ] 소유자 주소 입력 시 마커 생성
- [ ] 연락처 입력 시 마커 생성
- [ ] 메모 입력 시 마커 생성
- [ ] 모든 정보 삭제 시 마커 제거

### 성능 검증
- [ ] 색상 저장 < 100ms
- [ ] 페이지 로드 < 500ms (캐시 있음)
- [ ] 페이지 로드 < 2초 (캐시 없음)
- [ ] 마커 렌더링 < 10ms/개

### 안정성 검증
- [ ] 네트워크 오류 시 LocalStorage 백업
- [ ] 중복 저장 방지
- [ ] 메모리 누수 없음
- [ ] 콘솔 에러 없음

## Troubleshooting

### 색상이 저장되지 않음
1. 개발자 도구 Console 확인
2. Supabase 연결 상태 확인
3. LocalStorage 용량 확인

### 마커가 표시되지 않음
1. 필지 정보가 실제로 저장되었는지 확인
2. 마커 조건 필드 중 하나라도 값이 있는지 확인
3. 지도 줌 레벨 확인 (너무 축소되어 있지 않은지)

### 새로고침 후 데이터 사라짐
1. LocalStorage 데이터 확인
2. Supabase 테이블 데이터 확인
3. 세션 ID 일치 여부 확인

## Performance Monitoring

### 측정 도구
```javascript
// 콘솔에서 실행
performance.mark('start-load');
// ... 작업 수행 ...
performance.mark('end-load');
performance.measure('load-time', 'start-load', 'end-load');
console.log(performance.getEntriesByName('load-time'));
```

### 메모리 모니터링
1. 개발자 도구 > Performance > Memory
2. 장시간 사용 후 메모리 증가 확인
3. 가비지 컬렉션 후 메모리 해제 확인

## Success Criteria

모든 시나리오가 예상 결과와 일치하고, 검증 체크리스트의 모든 항목이 통과되면 기능이 성공적으로 구현된 것입니다.

## Next Steps

1. 모든 시나리오 테스트 완료
2. 성능 측정 결과 기록
3. 발견된 이슈 문서화
4. 사용자 피드백 수집