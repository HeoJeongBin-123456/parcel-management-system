#!/bin/sh

# Husky pre-commit hook
# Runs lint-staged which executes ESLint and tech debt scanner on staged files

. "$(dirname "$0")/_/husky.sh"

echo ""
echo "ğŸ” ê¸°ìˆ  ë¶€ì±„ ê²€ì¦ ì‹œì‘..."
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# Run lint-staged
npx lint-staged --allow-empty

# Store the result
LINT_STAGED_RESULT=$?

if [ $LINT_STAGED_RESULT -ne 0 ]; then
  echo ""
  echo "âŒ í—Œë²• ì¤€ìˆ˜ ê²€ì¦ ì‹¤íŒ¨!"
  echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
  echo ""
  echo "ğŸ”§ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:"
  echo "  1. ESLint ê·œì¹™ ìˆ˜ì •:"
  echo "     npx eslint --fix <file>"
  echo ""
  echo "  2. ê¸°ìˆ  ë¶€ì±„ í•­ëª© ì¶”ê°€:"
  echo "     npm run debt:add"
  echo ""
  echo "  3. ê¸°ìˆ  ë¶€ì±„ í•­ëª© ì—…ë°ì´íŠ¸:"
  echo "     npm run debt:update -- --id <ID> --status 'In Progress'"
  echo ""
  exit 1
fi

echo ""
echo "âœ… í—Œë²• ì¤€ìˆ˜ ê²€ì¦ í†µê³¼!"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
